knitr::opts_chunk$set(echo = TRUE)
fit_lin <- lm(adj_clost~sma + ema + macd + rsi)
fit_lin <- lm(adj_close~sma + ema + macd + rsi, data)
fit_lin <- lm(adj_close~sma + ema + macd + rsi, data= data)
data
data
fit_lin <- lm(adj_close~sma + ema + macd + rsi, data= data)
data %>%
filter(ticker=='AAPL') %>%
ggplot() +
geom_line(aes(x=date,y=adj_close)) +
geom_line(aes(x=date,y=sma),color='red')
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggcorrplot)
library(dplyr)
library(timetk)
library(ggplot2)
library(gridExtra)
summary(cars)
#grabbing the data
data <- read.csv('data.csv')
# reformatting data
names(data) <- tolower(names(data))
#rename columns
data <- data %>%
na.omit %>%
rename('adj_close' = 'adj.close',
'macd_signal' = 'macd.signal')
data <- data %>%
separate(col='date',into =c('month','day','year'),sep='\\/') %>%
unite(date,c('year','month','day'),sep = '-')
data$date <- as.Date(data$date)
data
#demonstrating correlation of variables with only Apple stocks
data %>%
filter(ticker =='AAPL') %>%
select(-date,-ticker) %>%
cor %>%
ggcorrplot
aapl <- data %>%
filter(ticker=='AAPL') %>%
ggplot()+
geom_line(aes(x = date,y=adj_close))
aapl_rsi <- data %>%
ggplot(aes(x=date,y=rsi)) +
geom_line()
grid.arrange(aapl,aapl_rsi,ncol=1)
data %>%
filter(ticker=='AAPL') %>%
ggplot() +
geom_line(aes(x=date,y=adj_close)) +
geom_line(aes(x=date,y=sma),color='red')
fit_lin <- lm(adj_close~sma + ema + macd + rsi, data= data)
fit_lin <- lm(adj_close~sma + ema + macd + rsi, data= data)
fit_lin
fit_lin <- lm(adj_close~sma + ema + macd + rsi, data = data)
fit_lin
data %>%
mutate(predictions = predict(fit_lin))
data %>%
mutate(predictions = predict(fit_lin)) %>%
select(adj_close)
data %>%
mutate(predictions = predict(fit_lin)) %>%
select(adj_close,predictions)
library(metrics)
library(metrics)
install.packages("Metrics")
library(Metrics)
fit_lin <- lm(adj_close~sma + ema + macd + rsi, data = data)
fit_lin
pred_lin <- data %>%
mutate(predictions = predict(fit_lin)) %>%
select(adj_close,predictions)
pred_lin <- data %>%
mutate(predictions = predict(fit_lin)) %>%
select(adj_close,predictions)
fit_lin <- lm(adj_close~sma + ema + macd + rsi, data = data)
pred_lin <- data %>%
mutate(predictions = predict(fit_lin)) %>%
select(adj_close,predictions)
rmse(pred_lin$adj_close,pred_lin$predictions)
aapl_price <- data %>%
filter(ticker=='AAPL') %>%
ggplot()+
geom_line(aes(x = date,y=adj_close))
aapl_rsi <- data %>%
ggplot(aes(x=date,y=rsi)) +
geom_line()
grid.arrange(aapl,aapl_rsi,ncol=1)
aapl_price <- data %>%
filter(ticker=='AAPL') %>%
ggplot()+
geom_line(aes(x = date,y=adj_close))
aapl_rsi <- data %>%
ggplot(aes(x=date,y=rsi)) +
geom_line()
grid.arrange(aapl_price,aapl_rsi,ncol=1)
aapl %>%
filter(ticker=='AAPL')
data %>%
filter(ticker=='AAPL')
aapl <- data %>%
filter(ticker=='AAPL')
aapl <- data %>%
filter(ticker=='AAPL')
aapl_price <- aapl %>%
ggplot()+
geom_line(aes(x = date,y=adj_close))
aapl_rsi <- aapl %>%
ggplot(aes(x=date,y=rsi)) +
geom_line()
grid.arrange(aapl_price,aapl_rsi,ncol=1)
fit_lin <- lm(adj_close~sma + ema + macd + rsi, data = aapl)
pred_lin <- aapl %>%
mutate(predictions = predict(fit_lin)) %>%
select(adj_close,predictions)
aapl %>%
ggplot() +
geom_line(aes(x=date,y=adj_close)) +
geom_line(aes(x=date,y=sma),color='red')
rmse(pred_lin$adj_close,pred_lin$predictions)
fit_lin <- lm(adj_close~sma + ema + macd + rsi, data = aapl)
pred_lin <- aapl %>%
mutate(predictions = predict(fit_lin)) %>%
select(adj_close,predictions)
aapl %>%
ggplot() +
geom_line(aes(x=date,y=adj_close)) +
geom_line(aes(x=date,y=predictions),color='red')
fit_lin <- lm(adj_close~sma + ema + macd + rsi, data = aapl)
pred_lin <- aapl %>%
mutate(predictions = predict(fit_lin)) %>%
select(adj_close,predictions,date)
aapl %>%
ggplot() +
geom_line(aes(x=date,y=adj_close)) +
geom_line(aes(x=date,y=predictions),color='red')
fit_lin <- lm(adj_close~sma + ema + macd + rsi, data = aapl)
pred_lin <- aapl %>%
mutate(predictions = predict(fit_lin)) %>%
select(adj_close,predictions,date)
pred_lin %>%
ggplot() +
geom_line(aes(x=date,y=adj_close)) +
geom_line(aes(x=date,y=predictions),color='red')
rmse(pred_lin$adj_close,pred_lin$predictions)
fit_lin <- lm(adj_close~sma + ema + macd + rsi, data = aapl)
pred_lin <- aapl %>%
mutate(predictions = predict(fit_lin)) %>%
select(adj_close,predictions,date)
pred_lin6 %>%
ggplot() +
geom_line(aes(x=date,y=adj_close)) +
geom_line(aes(x=date,y=predictions),color='red')
fit_lin <- lm(adj_close~sma + ema + macd + rsi, data = aapl)
pred_lin <- aapl %>%
mutate(predictions = predict(fit_lin)) %>%
select(adj_close,predictions,date)
pred_lin %>%
ggplot() +
geom_line(aes(x=date,y=adj_close)) +
geom_line(aes(x=date,y=predictions),color='red')
rmse(pred_lin$adj_close,pred_lin$predictions)
fit_lin <- lm(adj_close~sma + ema + macd + rsi, data = aapl)
pred_lin <- aapl %>%
mutate(predictions = predict(fit_lin)) %>%
select(adj_close,predictions,date)
pred_lin %>%
ggplot() +
geom_line(aes(x=date,y=adj_close)) +
geom_line(aes(x=date,y=predictions),color='red')
rmse(pred_lin$adj_close,pred_lin$predictions)
summary(fit_lin)$r.squared
fit_lin <- lm(adj_close~sma + ema + macd + rsi + volumne, data = aapl)
fit_lin <- lm(adj_close~sma + ema + macd + rsi + volume, data = aapl)
pred_lin <- aapl %>%
mutate(predictions = predict(fit_lin)) %>%
select(adj_close,predictions,date)
pred_lin %>%
ggplot() +
geom_line(aes(x=date,y=adj_close)) +
geom_line(aes(x=date,y=predictions),color='red')
rmse(pred_lin$adj_close,pred_lin$predictions)
summary(fit_lin)$r.squared
fit_lin <- lm(adj_close~sma + ema + macd + rsi , data = aapl)
pred_lin <- aapl %>%
mutate(predictions = predict(fit_lin)) %>%
select(adj_close,predictions,date)
pred_lin %>%
ggplot() +
geom_line(aes(x=date,y=adj_close)) +
geom_line(aes(x=date,y=predictions),color='red')
rmse(pred_lin$adj_close,pred_lin$predictions)
summary(fit_lin)$r.squared
fit_lin <- lm(adj_close~sma + ema + macd + rsi + volume, data = aapl)
pred_lin <- aapl %>%
mutate(predictions = predict(fit_lin)) %>%
select(adj_close,predictions,date)
pred_lin %>%
ggplot() +
geom_line(aes(x=date,y=adj_close)) +
geom_line(aes(x=date,y=predictions),color='red')
rmse(pred_lin$adj_close,pred_lin$predictions)
summary(fit_lin)$r.squared
library(caret)
